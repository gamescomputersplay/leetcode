'''  https://leetcode.com/problems/design-hashmap/
'''

class MyHashMap:

    def __init__(self, table_size=10):
        self.table_size = table_size
        self.table = [(None, None) for _ in range(self.table_size)]
        self.usage = 0
        self.waste = 0

    def resize_table(self, new_size):
        ''' Double the table size
        '''
        new_hash = MyHashMap(new_size)
        # This is actually a list, so no need for .items()
        for key, value in self.table:
            if key is not None:
                new_hash.put(key, value)
        self.table_size = new_hash.table_size
        self.table = new_hash.table
        self.usage = new_hash.usage


    def put(self, key, value):
        ''' Add an item to the has table '''
        address = key % self.table_size
        while True:
            if self.table[address] == (None, None) or self.table[address][0] == key:
                self.table[address] = (key, value)
                self.usage += 1
                if self.usage / self.table_size > .3:
                    self.resize_table(self.table_size * 2)
                break
            address += 1
            address %= self.table_size

    def get(self, key) -> int:
        ''' Get item from the hash table '''
        address = key % self.table_size
        while True:
            if self.table[address][0] == key:
                return self.table[address][1]
            if self.table[address] == (None, None):
                return -1
            address += 1
            address %= self.table_size

    def remove(self, key) -> None:
        ''' Remove item from teh hash table '''
        address = key % self.table_size
        # (None, 1) is a sign of "Empty, but redirect to the next one"
        while True:
            if self.table[address][0] == key:
                self.table[address] = (None, 1)
                self.usage -= 1
                self.waste += 1
                if self.waste / self.table_size > .3:
                    self.resize_table(self.table_size)
                return  None
            if self.table[address] == (None, None):
                return None
            address += 1
            address %= self.table_size



if __name__ == "__main__":
    commands = ["put", "put", "get", "get", "put", "get", "remove", "get"]
    parameters = [[1, 1], [2, 2], [1], [3], [2, 1], [2], [2], [2]]
    # size = 100
    # commands = ["put"] * size
    # parameters = [[int(i*2.3), int(i*1.7)] for i in range(size)]

    commands = ["remove","put","remove","remove","get","remove","put","get","remove","put","put","put","put","put","put","put","put","put","put","put","remove","put","put","get","put","get","put","put","get","put","remove","remove","put","put","get","remove","put","put","put","get","put","put","remove","put","remove","remove","remove","put","remove","get","put","put","put","put","remove","put","get"]
    parameters = [[27],[65,65],[19],[0],[18],[3],[42,0],[19],[42],[17,90],[31,76],[48,71],[5,50],[7,68],[73,74],[85,18],[74,95],[84,82],[59,29],[71,71],[42],[51,40],[33,76],[17],[89,95],[95],[30,31],[37,99],[51],[95,35],[65],[81],[61,46],[50,33],[59],[5],[75,89],[80,17],[35,94],[80],[19,68],[13,17],[70],[28,35],[99],[37],[13],[90,83],[41],[50],[29,98],[54,72],[6,8],[51,88],[13],[8,22],[85]]

    commands = ["MyHashMap","put","get","put","put","put","remove","get","put","put","remove","put","put","put","get","put","put","put","put","put","put","put","remove","put","put","put","put","put","put","put","put","put","put","put","put","get","remove","get","get","put","put","put","put","remove","put","remove","remove","put","remove","remove","put","get","put","put","get","put","put","put","get","put","put","get","put","put","get","remove","get","put","remove","put","get","put","get","get","put","remove","put","put","put","put","put","put","put","put","put","put","get","remove","put","remove","put","remove","put","put","put","put","put","put","put","get","remove","put","put","remove","remove","put","remove","put","put","get","remove","put","remove","put","remove","put","put","put","put","get","put","put","put","put","put","put","remove","put","remove","put","remove","put","get","remove","put","put","put","put","remove","put","put","put","remove","put","put","get","put","put","put","put","put","get","put","get","put","remove","remove","get","get","put","put","put","remove","put","put","put","put","put","put","put","remove","put","put","get","put","put","put","remove","put","get","put","remove","put","put","put","get","put","put","put","put","get","remove","remove","put","put","put","get","put","put","put","put","put","put","remove","put","put","get","put","remove","put","put","put","put","put","put","put","put","remove","put","put","put","remove","put","put","put","put","put","put","get","put","put","put","put","put","put","remove","get","remove","put","put","put","put","put","put","put","put","put","get","put","put","put","get","put","put","put","get","put","put","remove","put","get","put","put","put","put","put","put","put","put","put","remove","put","put","put","put","put","get","remove","put","put","put","put","put","put","put","put","put","put","put","get","put","get","put","put","put","get","put","put","put","put","get","put","put","put","put","put","put","put","put","remove","put","put","get","put","put","put","put","put","remove","get","put","put","put","put","put","put","get","put","put","remove","put","put","remove","remove","put","put","remove","put","get","put","put","get","put","get","get","put","remove","remove","put","get","put","get","remove","get","get","put","put","put","put","put","put","put","get","put","put","put","put","remove","get","put","get","get","get","put","put","get","put","put","put","put","put","remove","put","put","put","put","put","put","put","put","put","get","put","put","put","put","put","put","put","put","put","put","put","put","get","put","put","get","put","remove","get","put","put","put","remove","get","put","get","put","get","put","remove","remove","get","put","put","put","get","put","put","put","put","put","get","put","get","put","put","put","put","get","get","put","remove","remove","remove","put","get","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","get","remove","put","put","get","put","put","put","put","put","get","put","remove","put","put","put","put","get","put","put","put","put","put","put","get","get","get","remove","put","remove","remove","remove","put","remove","put","put","put","put","get","put","put","get","put","put","put","put","put","put","get","remove","put","get","put","put","put","put","get","put","put","put","put","get","put","put","put","get","remove","put","put","put","put","put","put","put","put","put","put","put","put","remove","put","put","put","put","remove","get","put","put","get","put","put","put","put","put","get","get","remove","get","put","put","put","get","put","put","put","get","put","put","put","put","put","get","put","put","put","put","put","get","remove","put","remove","put","put","put","put","get","get","remove","put","put","get","get","put","put","get","put","put","put","put","put","put","put","get","remove","put","put","put","remove","get","put","put","put","remove","put","put","remove","put","put","get","put","remove","get","put","put","put","put","put","put","remove","put","remove","remove","put","get","get","put","get","get","put","put","put","put","remove","put","put","remove","put","put","put","put","put","remove","put","put","put","put","put","get","put","put","put","put","remove","put","put","get","remove","remove","put","get","put","get","put","put","put","remove","put","put","put","remove","put","put","remove","put","put","put","put","put","put","put","put","put","put","remove","remove","remove","remove","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","get","put","get","put","put","put","put","put","put","remove","remove","get","remove","get","remove","put","get","remove","get","remove","get","put","put","put","put","put","put","put","put","put","put","put","put","put","put","put","remove","remove","put","put","put","put","put","put","remove","get","put","put","get","remove","put","put","put","put","put","put","put","put","put","remove","remove","remove","get","put","get","remove","put","put","get","put","get","put","get","remove","get","put","remove","remove","remove","get","put","put","get","remove","put","put","put","put","get","put","put","put","put","put","put","put","get","get","put","put","put","put","put","put","put","put","put","put","get","put","put","put","put","remove","put","remove","put","get","put","remove","put","get","put","get","put","remove","put","get","put","remove","put","remove","remove","put","put","remove","put","remove","put","put","get","put","put","get","put","get","put","put","put","remove","get","get","put","put","put","put","put","put","get","put","remove","put","get","remove","put","put","put","put","get","put","put","put","put","put","put","remove","put","put","remove","put","remove","remove","get","remove","get","put","put","put","put","put","put","remove","put","get","put","get","put","remove","remove","put","put","put","get","remove","get","put","remove","remove","put","remove","put","put","put","get","get","put","put","put","put","put","put","get","remove","put","put","get","put","get","put","remove","put","put","remove","get","put","get","put","get","put","put","put","get","remove","put","get","get","put","put","put","get","put","put","put","put","put","put","put","put","put","get","get","put","put","put","get","get","put","put","put","remove","put","put","get","put"]
    parameters = [[],[694,526],[842],[792,588],[481,43],[752,320],[481],[241],[955,838],[283,431],[481],[586,423],[952,501],[94,306],[715],[962,790],[420,949],[746,156],[17,57],[258,803],[329,958],[931,759],[481],[936,138],[90,715],[238,109],[931,375],[580,381],[566,98],[616,280],[250,774],[567,700],[927,312],[346,940],[949,618],[955],[581],[464],[740],[416,700],[993,180],[447,766],[609,554],[962],[256,632],[90],[792],[314,597],[37],[334],[221,599],[256],[351,440],[286,686],[960],[401,315],[220,668],[333,400],[281],[936,261],[397,334],[237],[952,46],[998,463],[439],[609],[979],[801,179],[242],[281,27],[947],[874,218],[952],[258],[879,622],[523],[39,68],[799,193],[15,555],[647,604],[149,294],[381,78],[442,545],[414,834],[409,115],[751,860],[70],[881],[938,680],[884],[369,600],[381],[945,329],[513,564],[494,468],[166,911],[609,494],[384,448],[975,21],[421],[799],[382,130],[615,970],[447],[286],[524,195],[586],[471,937],[682,685],[382],[791],[604,5],[761],[53,734],[302],[611,330],[918,24],[788,260],[809,895],[518],[164,514],[632,823],[425,837],[640,132],[829,120],[104,169],[647],[29,725],[437],[139,442],[779],[652,796],[757],[339],[702,668],[45,862],[303,242],[489,723],[829],[622,443],[177,621],[693,204],[333],[292,162],[978,696],[918],[888,930],[944,606],[401,885],[329,563],[282,824],[45],[679,218],[274],[3,115],[694],[223],[823],[580],[568,431],[917,173],[374,500],[611],[744,8],[965,667],[180,654],[634,554],[594,282],[385,164],[313,813],[634],[497,712],[283,336],[414],[920,782],[600,658],[962,288],[872],[475,70],[743],[975,616],[792],[160,181],[569,27],[95,323],[238],[993,754],[920,960],[260,188],[850,799],[615],[567],[396],[937,948],[385,519],[391,297],[492],[951,48],[493,166],[76,213],[850,575],[478,959],[224,897],[632],[833,625],[980,357],[799],[370,86],[221],[10,567],[157,861],[50,398],[819,632],[170,341],[471,412],[616,757],[200,416],[494],[775,430],[961,145],[391,31],[962],[72,893],[252,79],[907,530],[283,208],[553,287],[224,991],[76],[516,781],[854,675],[846,170],[272,783],[947,548],[294,310],[293],[524],[611],[906,11],[147,498],[751,665],[61,817],[812,828],[64,635],[74,973],[57,660],[716,842],[374],[846,95],[481,722],[310,161],[290],[363,647],[305,116],[656,870],[585],[929,735],[407,435],[157],[369,572],[984],[902,150],[754,736],[94,460],[973,591],[369,385],[102,79],[951,723],[236,568],[679,195],[663],[427,590],[457,99],[170,692],[282,276],[112,29],[902],[351],[657,555],[572,648],[235,519],[858,183],[459,545],[217,25],[545,748],[933,118],[820,6],[676,497],[268,308],[194],[574,289],[370],[850,409],[102,678],[945,304],[19],[638,912],[750,552],[268,828],[671,117],[951],[789,330],[458,356],[357,491],[653,690],[544,899],[153,159],[170,838],[951,70],[958],[933,51],[960,995],[236],[6,106],[608,482],[136,180],[601,564],[466,816],[305],[277],[419,571],[438,99],[536,46],[669,840],[340,53],[37,197],[567],[460,367],[393,52],[513],[568,754],[924,826],[553],[789],[556,864],[298,720],[577],[455,537],[604],[567,909],[785,278],[945],[77,255],[586],[137],[550,123],[929],[544],[581,536],[436],[356,522],[260],[420],[64],[385],[80,880],[351,6],[312,114],[636,774],[973,797],[298,241],[742,591],[938],[472,644],[792,172],[164,299],[784,380],[283],[904],[793,68],[579],[572],[805],[296,242],[316,506],[547],[207,351],[20,733],[884,552],[170,55],[762,32],[961],[316,321],[986,115],[20,685],[859,523],[691,125],[587,260],[198,311],[59,410],[457,860],[947],[186,7],[214,946],[407,208],[813,730],[665,800],[657,392],[503,923],[105,34],[254,786],[999,278],[213,146],[654,836],[754],[427,984],[112,515],[258],[943,691],[706],[784],[78,918],[762,368],[815,434],[15],[283],[472,174],[340],[646,576],[280],[410,734],[604],[332],[170],[465,260],[609,834],[821,137],[147],[707,397],[424,53],[811,579],[450,719],[845,16],[61],[358,539],[463],[718,22],[166,593],[903,686],[692,49],[933],[268],[27,176],[982],[986],[349],[631,737],[955],[87,375],[520,152],[372,184],[1,1],[489,389],[144,677],[654,88],[836,765],[818,914],[208,719],[174,306],[368,185],[78,51],[795,898],[52,274],[302,408],[503,403],[799,974],[578,199],[907,970],[718],[164],[827,38],[49,219],[474],[426,683],[376,619],[15,525],[968,499],[373,704],[302],[405,760],[841],[541,789],[255,831],[215,204],[455,808],[858],[729,409],[486,690],[763,308],[984,348],[628,505],[334,88],[724],[435],[611],[359],[977,502],[928],[975],[320],[853,74],[452],[38,385],[342,238],[574,724],[105,985],[586],[233,616],[107,104],[94],[53,422],[256,127],[773,584],[13,285],[647,365],[272,570],[773],[340],[525,616],[368],[966,800],[844,421],[184,635],[323,820],[901],[312,983],[340,849],[210,471],[767,190],[184],[874,385],[234,249],[627,989],[281],[103],[455,233],[191,46],[421,879],[269,420],[495,500],[776,119],[375,890],[402,1],[425,538],[677,116],[190,890],[279,543],[999],[32,238],[690,112],[327,530],[464,928],[494],[410],[690,623],[909,623],[15],[581,897],[540,749],[392,982],[541,5],[878,482],[845],[204],[906],[828],[712,423],[466,585],[893,426],[382],[659,56],[284,80],[992,255],[541],[28,360],[562,188],[53,737],[361,50],[710,261],[540],[275,648],[213,904],[22,841],[835,142],[461,166],[809],[690],[785,808],[550],[321,999],[721,434],[743,532],[45,504],[457],[201],[917],[895,286],[621,674],[525],[553],[970,903],[303,717],[657],[267,774],[440,226],[954,849],[486,129],[437,722],[433,603],[227,267],[182],[66],[866,376],[691,943],[714,241],[678],[553],[994,794],[348,799],[87,881],[77],[717,665],[549,111],[837],[345,179],[781,676],[157],[727,32],[808],[28],[422,61],[972,782],[680,607],[478,726],[788,387],[645,117],[37],[514,98],[134],[844],[812,447],[710],[691],[934,117],[334],[286],[288,179],[20,978],[347,982],[125,769],[820],[219,120],[134,135],[334],[550,104],[235,514],[494,487],[969,670],[878,494],[894],[809,310],[889,268],[486,409],[174,676],[350,208],[75],[204,631],[132,324],[238,494],[53,740],[960],[853,4],[823,191],[945],[671],[263],[997,60],[652],[994,784],[729],[830,426],[463,728],[21,270],[216],[916,690],[296,498],[791,215],[410],[866,687],[6,885],[252],[482,790],[449,238],[142,954],[592,700],[345,633],[851,111],[615,936],[699,269],[593,884],[71,268],[764],[844],[29],[520],[352,659],[35,273],[675,75],[36,801],[688,219],[435,818],[92,868],[456,508],[800,602],[484,441],[602,547],[238,246],[910,165],[762,322],[736,230],[126,330],[12,61],[761,316],[963,346],[530,539],[736,793],[283,370],[940],[425,624],[220],[161,324],[925,382],[902,308],[661,836],[53,804],[101,744],[12],[184],[328],[699],[801],[65],[322,890],[836],[87],[556],[654],[457],[468,578],[897,314],[696,25],[268,927],[768,552],[572,839],[326,248],[880,501],[950,84],[337,543],[792,16],[981,225],[385,363],[631,795],[665,632],[889],[831],[853,992],[381,569],[479,149],[951,381],[532,165],[934,525],[5],[622],[989,826],[678,801],[906],[527],[600,434],[838,705],[853,57],[792,489],[381,767],[322,251],[321,535],[853,986],[942,163],[282],[493],[951],[947],[575,834],[507],[568],[479,299],[5,960],[513],[885,710],[144],[670,732],[28],[243],[981],[585,309],[726],[49],[498],[174],[912,166],[164,464],[781],[115],[654,677],[364,997],[780,505],[968,107],[361],[815,777],[581,299],[230,22],[77,570],[536,383],[85,557],[805,826],[983],[236],[390,930],[680,141],[398,601],[119,222],[820,53],[419,645],[188,788],[570,134],[772,179],[353,127],[545],[268,832],[22,672],[364,177],[266,746],[772],[102,928],[219],[600,146],[746],[895,262],[642],[427,868],[515],[209,169],[945],[692,251],[696],[291,968],[909],[775,48],[525],[811,591],[884],[513],[399,596],[521,587],[352],[609,780],[357],[452,486],[409,547],[722],[674,533],[199,812],[784],[137,818],[35],[23,391],[252,949],[146,940],[844],[12],[401],[941,515],[45,701],[280,607],[378,489],[924,126],[579,327],[368],[186,139],[495],[893,731],[282],[450],[991,82],[967,73],[195,976],[354,461],[162],[586,188],[295,45],[283,874],[840,50],[979,148],[370,28],[968],[688,970],[206,515],[295],[398,738],[884],[677],[307],[716],[206],[293,41],[75,54],[328,801],[77,803],[156,720],[476,99],[27],[254,904],[971],[308,847],[829],[712,931],[847],[703],[152,880],[841,133],[957,444],[102],[0],[768],[442,631],[256],[28],[480,837],[768],[708,682],[957,459],[753,320],[994],[29],[725,661],[474,657],[438,8],[350,974],[465,532],[254,999],[884],[815],[208,677],[259,909],[41],[328,616],[830],[236,328],[435],[70,895],[730,556],[987],[102],[721,578],[712],[675,925],[7],[519,75],[554,190],[88,304],[160],[929],[995,147],[652],[407],[926,213],[668,19],[432,26],[482],[976,765],[499,817],[924,776],[847,495],[926,999],[348,361],[688,933],[261,811],[474,513],[61],[984],[591,861],[627,598],[86,606],[723],[462],[348,411],[330,662],[997,886],[261],[859,819],[948,250],[691],[670,829]]

    commands = ["MyHashMap","put","get","put","put","put","remove","get","put","put","remove","put","put","put","get","put","put","put","put","put","put","put","remove","put","put","put","put","put","put","put","put","put","put","put","put","get","remove","get","get","put","put","put","put","remove","put","remove","remove","put","remove","remove","put","get","put","put","get","put","put","put","get","put","put","get","put","put","get","remove","get","put","remove","put","get","put","get","get"]
    parameters = [[],[694,526],[842],[792,588],[481,43],[752,320],[481],[241],[955,838],[283,431],[481],[586,423],[952,501],[94,306],[715],[962,790],[420,949],[746,156],[17,57],[258,803],[329,958],[931,759],[481],[936,138],[90,715],[238,109],[931,375],[580,381],[566,98],[616,280],[250,774],[567,700],[927,312],[346,940],[949,618],[955],[581],[464],[740],[416,700],[993,180],[447,766],[609,554],[962],[256,632],[90],[792],[314,597],[37],[334],[221,599],[256],[351,440],[286,686],[960],[401,315],[220,668],[333,400],[281],[936,261],[397,334],[237],[952,46],[998,463],[439],[609],[979],[801,179],[242],[281,27],[947],[874,218],[952]]

    hashmap = MyHashMap()

    for command, parameter in zip(commands, parameters):
        print(command, parameter)
        if command == "MyHashMap":
            continue
        if command == "put":
            hashmap.put(parameter[0], parameter[1])
        if command == "get":
            result = hashmap.get(parameter[0])
            print("result", result)
        if command == "remove":
            hashmap.remove(parameter[0])
        print(hashmap.table)   
